(function(e,t){if(typeof exports==="object"){module.exports=t(require("backbone"),require("react"),require("underscore"))}else if(typeof define==="function"&&define.amd){define(["backbone","react","underscore"],t)}else{e.amdWeb=t(e.Backbone,e.React,e._)}})(this,function(e,t,n){"use strict";var r={changeOptions:"add remove reset sort",updateScheduler:function(e){return n.debounce(e,0)}};var i={changeOptions:"change",updateScheduler:n.identity};var s=function(t,n,s){if(!n){return}var o=n instanceof e.Collection?r:i;var u=o.updateScheduler(function(){if(t.isMounted()){(t.onModelChange||t.forceUpdate).call(t)}});var a=s||t.changeOptions||o.changeOptions;n.on(a,u,t)};var o=function(e,t){if(!t){return}t.off(null,null,e)};t.BackboneMixin=function(e,t){var n,r;if(typeof e==="object"){t=e.renderOn;n=e.propName;r=e.modelOrCollection}else{n=e}if(!r){r=function(e){return e[n]}}return{componentDidMount:function(){s(this,r(this.props),t)},componentWillReceiveProps:function(e){if(r(this.props)===r(e)){return}o(this,r(this.props));s(this,r(e),t);if(typeof this.componentWillChangeModel==="function"){this.componentWillChangeModel()}},componentDidUpdate:function(e,t){if(r(this.props)===r(e)){return}if(typeof this.componentDidChangeModel==="function"){this.componentDidChangeModel()}},componentWillUnmount:function(){o(this,r(this.props))}}};t.BackboneViewMixin={getModel:function(){return this.props.model},model:function(){return this.getModel()},getCollection:function(){return this.props.collection},collection:function(){return this.getCollection()},el:function(){return this.isMounted()&&this.getDOMNode()}};t.createBackboneClass=function(e){var n=e.mixins||[];e.mixins=n.concat([t.BackboneMixin("model"),t.BackboneMixin("collection"),t.BackboneViewMixin]);return t.createClass(e)};return t})